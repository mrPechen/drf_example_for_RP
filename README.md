# drf_example_for_RP


Для запуска из докера:

  1. Клонировать проект.
  2. Убрать расширение txt у файла ".env.txt" и изменить параметры для Postgres и RabbitMQ.

    Запуск базы для тестов:

    1. Запустить команду "docker compose -f test_compose.yaml up --build" из корня проекта.
    2. После запуска контейнеров в новой вкладке терминала запустить команду pytest -s.


    Запуск проекта с Celery:

    1. Остановить предыдущие контейнеры, если они активны.
    2. Запустить команду "docker compose -f docker-compose.yaml up --build" из корня проекта.Сервис будет доступен по адресу "http://0.0.0.0:8000/api/v1"


Эндпоинты:
- http://0.0.0.0:8000/api/v1 - Swagger документация.
- http://0.0.0.0:8000/api/v1/user/register/ - POST запрос. Регистрация пользователя по почте и паролю. Ожидает JSON в формате {"email": "email@email.com", "password": 1234/"1234qwer"}.
- http://0.0.0.0:8000/api/v1/user/login/ - POST запрос. Получение JWT токена по почте и паролю указанных при регистрации. Ожидает JSON в формате {"email": "email@email.com", "password": 1234/"1234qwer"}.
- http://0.0.0.0:8000/api/v1/rates/ | http://0.0.0.0:8000/api/v1/rates/?value=(value or -value) - GET запрос. Получение всех последних загруженных котировок для анонимных пользователей. Для авторизованнх пользователей возвращает список отслеживаемых валют. При указании значения "value" вовращается отсортированный список по возрастанию или убыванию.
- http://0.0.0.0:8000/api/v1/currency/user_currency/ - POST запрос на добавление отслеживаемых валют. Только для авторизованных пользователей. Ожидает JSON в формате {"currency": 1(id валюты), "threshold": 100/100.0 (ПЗ)}.
- http://0.0.0.0:8000/api/v1/currency/<int:id>/analytic?date_from=year-month-day&date_to=year-month-day&threshold=int or float - GET запрос. Возвращает список с расширенными полями для аналитики. id = id валюты, date_from = дата начала диапазона для выгрузки, date_to = дата окончания диапазона для выгрузки, threshold = ожидаемая цена валюты.
